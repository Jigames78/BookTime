{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { DEFAULT_HEADERS } from '../lib/constants';\nimport { isStorageError } from '../lib/errors';\nimport { get, post, remove } from '../lib/fetch';\nimport { resolveFetch } from '../lib/helpers';\n/**\r\n * API class for managing Analytics Buckets using Iceberg tables\r\n * Provides methods for creating, listing, and deleting analytics buckets\r\n */\nexport default class StorageAnalyticsApi {\n  /**\r\n   * Creates a new StorageAnalyticsApi instance\r\n   * @param url - The base URL for the storage API\r\n   * @param headers - HTTP headers to include in requests\r\n   * @param fetch - Optional custom fetch implementation\r\n   */\n  constructor(url) {\n    let headers = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    let fetch = arguments.length > 2 ? arguments[2] : undefined;\n    this.shouldThrowOnError = false;\n    this.url = url.replace(/\\/$/, '');\n    this.headers = Object.assign(Object.assign({}, DEFAULT_HEADERS), headers);\n    this.fetch = resolveFetch(fetch);\n  }\n  /**\r\n   * Enable throwing errors instead of returning them in the response\r\n   * When enabled, failed operations will throw instead of returning { data: null, error }\r\n   *\r\n   * @returns This instance for method chaining\r\n   */\n  throwOnError() {\n    this.shouldThrowOnError = true;\n    return this;\n  }\n  /**\r\n   * Creates a new analytics bucket using Iceberg tables\r\n   * Analytics buckets are optimized for analytical queries and data processing\r\n   *\r\n   * @param name A unique name for the bucket you are creating\r\n   * @returns Promise with newly created bucket name or error\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const { data, error } = await storage.analytics.createBucket('analytics-data')\r\n   * if (error) {\r\n   *   console.error('Failed to create analytics bucket:', error.message)\r\n   * } else {\r\n   *   console.log('Created bucket:', data.name)\r\n   * }\r\n   * ```\r\n   */\n  createBucket(name) {\n    return __awaiter(this, void 0, void 0, function* () {\n      try {\n        const data = yield post(this.fetch, \"\".concat(this.url, \"/bucket\"), {\n          name\n        }, {\n          headers: this.headers\n        });\n        return {\n          data,\n          error: null\n        };\n      } catch (error) {\n        if (this.shouldThrowOnError) {\n          throw error;\n        }\n        if (isStorageError(error)) {\n          return {\n            data: null,\n            error\n          };\n        }\n        throw error;\n      }\n    });\n  }\n  /**\r\n   * Retrieves the details of all Analytics Storage buckets within an existing project\r\n   * Only returns buckets of type 'ANALYTICS'\r\n   *\r\n   * @param options Query parameters for listing buckets\r\n   * @param options.limit Maximum number of buckets to return\r\n   * @param options.offset Number of buckets to skip\r\n   * @param options.sortColumn Column to sort by ('id', 'name', 'created_at', 'updated_at')\r\n   * @param options.sortOrder Sort order ('asc' or 'desc')\r\n   * @param options.search Search term to filter bucket names\r\n   * @returns Promise with list of analytics buckets or error\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const { data, error } = await storage.analytics.listBuckets({\r\n   *   limit: 10,\r\n   *   offset: 0,\r\n   *   sortColumn: 'created_at',\r\n   *   sortOrder: 'desc',\r\n   *   search: 'analytics'\r\n   * })\r\n   * if (data) {\r\n   *   console.log('Found analytics buckets:', data.length)\r\n   *   data.forEach(bucket => console.log(`- ${bucket.name}`))\r\n   * }\r\n   * ```\r\n   */\n  listBuckets(options) {\n    return __awaiter(this, void 0, void 0, function* () {\n      try {\n        // Build query string from options\n        const queryParams = new URLSearchParams();\n        if ((options === null || options === void 0 ? void 0 : options.limit) !== undefined) queryParams.set('limit', options.limit.toString());\n        if ((options === null || options === void 0 ? void 0 : options.offset) !== undefined) queryParams.set('offset', options.offset.toString());\n        if (options === null || options === void 0 ? void 0 : options.sortColumn) queryParams.set('sortColumn', options.sortColumn);\n        if (options === null || options === void 0 ? void 0 : options.sortOrder) queryParams.set('sortOrder', options.sortOrder);\n        if (options === null || options === void 0 ? void 0 : options.search) queryParams.set('search', options.search);\n        const queryString = queryParams.toString();\n        const url = queryString ? \"\".concat(this.url, \"/bucket?\").concat(queryString) : \"\".concat(this.url, \"/bucket\");\n        const data = yield get(this.fetch, url, {\n          headers: this.headers\n        });\n        return {\n          data: data,\n          error: null\n        };\n      } catch (error) {\n        if (this.shouldThrowOnError) {\n          throw error;\n        }\n        if (isStorageError(error)) {\n          return {\n            data: null,\n            error\n          };\n        }\n        throw error;\n      }\n    });\n  }\n  /**\r\n   * Deletes an existing analytics bucket\r\n   * A bucket can't be deleted with existing objects inside it\r\n   * You must first empty the bucket before deletion\r\n   *\r\n   * @param bucketId The unique identifier of the bucket you would like to delete\r\n   * @returns Promise with success message or error\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const { data, error } = await analyticsApi.deleteBucket('old-analytics-bucket')\r\n   * if (error) {\r\n   *   console.error('Failed to delete bucket:', error.message)\r\n   * } else {\r\n   *   console.log('Bucket deleted successfully:', data.message)\r\n   * }\r\n   * ```\r\n   */\n  deleteBucket(bucketId) {\n    return __awaiter(this, void 0, void 0, function* () {\n      try {\n        const data = yield remove(this.fetch, \"\".concat(this.url, \"/bucket/\").concat(bucketId), {}, {\n          headers: this.headers\n        });\n        return {\n          data,\n          error: null\n        };\n      } catch (error) {\n        if (this.shouldThrowOnError) {\n          throw error;\n        }\n        if (isStorageError(error)) {\n          return {\n            data: null,\n            error\n          };\n        }\n        throw error;\n      }\n    });\n  }\n}\n//# sourceMappingURL=StorageAnalyticsApi.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}