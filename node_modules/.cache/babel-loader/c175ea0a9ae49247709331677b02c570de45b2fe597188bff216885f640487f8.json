{"ast":null,"code":"const ANILIST_API = 'https://graphql.anilist.co';\n\n// Recherche sur Anilist (manhwas, mangas, webtoons) - VERSION AMÃ‰LIORÃ‰E\nexport const searchAnilistCover = async title => {\n  // Nettoyer le titre pour amÃ©liorer la recherche\n  let cleanTitle = title.replace(/\\s*ep\\s*\\d+.*$/i, '') // Supprimer \"ep XXX\"\n  .replace(/\\s*chapter\\s*\\d+.*$/i, '') // Supprimer \"chapter XXX\"\n  .replace(/\\s*end\\s*$/i, '') // Supprimer \"End\"\n  .trim();\n  const query = `\n    query ($search: String) {\n      Media(search: $search, type: MANGA, sort: SEARCH_MATCH) {\n        id\n        title {\n          romaji\n          english\n          native\n        }\n        coverImage {\n          extraLarge\n          large\n          medium\n        }\n        format\n        countryOfOrigin\n      }\n    }\n  `;\n  try {\n    var _data$data, _data$data$Media;\n    const response = await fetch(ANILIST_API, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json'\n      },\n      body: JSON.stringify({\n        query,\n        variables: {\n          search: cleanTitle\n        }\n      })\n    });\n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n    const data = await response.json();\n    if ((_data$data = data.data) !== null && _data$data !== void 0 && (_data$data$Media = _data$data.Media) !== null && _data$data$Media !== void 0 && _data$data$Media.coverImage) {\n      const cover = data.data.Media.coverImage.extraLarge || data.data.Media.coverImage.large || data.data.Media.coverImage.medium;\n      if (cover) {\n        console.log(`âœ… [AniList] TrouvÃ© pour \"${cleanTitle}\":`, data.data.Media.title.romaji || data.data.Media.title.english);\n        return cover;\n      }\n    }\n  } catch (error) {\n    console.log(`âŒ [AniList] Erreur pour \"${cleanTitle}\":`, error.message);\n  }\n  return null;\n};\n\n// Recherche sur Google Books\nexport const searchGoogleBooksCover = async title => {\n  try {\n    var _data$items$, _data$items$$volumeIn;\n    const response = await fetch(`https://www.googleapis.com/books/v1/volumes?q=${encodeURIComponent(title)}&maxResults=1`);\n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n    const data = await response.json();\n    if (data.items && (_data$items$ = data.items[0]) !== null && _data$items$ !== void 0 && (_data$items$$volumeIn = _data$items$.volumeInfo) !== null && _data$items$$volumeIn !== void 0 && _data$items$$volumeIn.imageLinks) {\n      const imageLinks = data.items[0].volumeInfo.imageLinks;\n      // Remplacer http par https pour Ã©viter les erreurs\n      const url = imageLinks.large || imageLinks.medium || imageLinks.thumbnail;\n      return url ? url.replace('http://', 'https://') : null;\n    }\n  } catch (error) {\n    console.log('Google Books: couverture non trouvÃ©e pour', title, error.message);\n  }\n  return null;\n};\n\n// GÃ©nÃ©ration de fallback avec style manga/anime\nconst getFallbackCover = title => {\n  // Utiliser des images d'anime/manga par dÃ©faut de Lorem Picsum avec IDs spÃ©cifiques\n  const animeImageIds = [237, 1084, 1025, 823, 452, 883, 1069, 548, 659, 485, 593, 1074, 929, 447];\n  const seed = title.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);\n  const imageId = animeImageIds[seed % animeImageIds.length];\n\n  // Ajouter un filtre pour donner un aspect \"manga/anime\"\n  return `https://picsum.photos/id/${imageId}/400/600?grayscale&blur=1`;\n};\n\n// Fonction principale qui essaie toutes les sources\nexport const getCoverUrl = async title => {\n  console.log(`ðŸ” Recherche de couverture pour: \"${title}\"`);\n\n  // Essayer d'abord Anilist (meilleur pour manhwas/webtoons/mangas)\n  let cover = await searchAnilistCover(title);\n  if (cover) {\n    console.log(`âœ… Couverture AniList trouvÃ©e pour: ${title}`);\n    return cover;\n  }\n\n  // Puis Google Books (pour les light novels)\n  cover = await searchGoogleBooksCover(title);\n  if (cover) {\n    console.log(`âœ… Couverture Google Books trouvÃ©e pour: ${title}`);\n    return cover;\n  }\n\n  // Fallback : image gÃ©nÃ©rÃ©e avec style manga\n  console.log(`âš ï¸ Aucune couverture trouvÃ©e, utilisation fallback pour: ${title}`);\n  return getFallbackCover(title);\n};\n\n// Version synchrone pour l'import rapide (utilise fallback immÃ©diatement)\nexport const getCoverUrlSync = title => {\n  return getFallbackCover(title);\n};\n\n// Fonction pour mettre Ã  jour une couverture aprÃ¨s coup\nexport const updateCoverAsync = async title => {\n  return await getCoverUrl(title);\n};","map":{"version":3,"names":["ANILIST_API","searchAnilistCover","title","cleanTitle","replace","trim","query","_data$data","_data$data$Media","response","fetch","method","headers","body","JSON","stringify","variables","search","ok","Error","status","data","json","Media","coverImage","cover","extraLarge","large","medium","console","log","romaji","english","error","message","searchGoogleBooksCover","_data$items$","_data$items$$volumeIn","encodeURIComponent","items","volumeInfo","imageLinks","url","thumbnail","getFallbackCover","animeImageIds","seed","split","reduce","acc","char","charCodeAt","imageId","length","getCoverUrl","getCoverUrlSync","updateCoverAsync"],"sources":["/etudiants/siscol/f/ferna_ji/Bureau/BookTime/src/utils/imageGenerator.js"],"sourcesContent":["const ANILIST_API = 'https://graphql.anilist.co';\n\n// Recherche sur Anilist (manhwas, mangas, webtoons) - VERSION AMÃ‰LIORÃ‰E\nexport const searchAnilistCover = async (title) => {\n  // Nettoyer le titre pour amÃ©liorer la recherche\n  let cleanTitle = title\n    .replace(/\\s*ep\\s*\\d+.*$/i, '') // Supprimer \"ep XXX\"\n    .replace(/\\s*chapter\\s*\\d+.*$/i, '') // Supprimer \"chapter XXX\"\n    .replace(/\\s*end\\s*$/i, '') // Supprimer \"End\"\n    .trim();\n\n  const query = `\n    query ($search: String) {\n      Media(search: $search, type: MANGA, sort: SEARCH_MATCH) {\n        id\n        title {\n          romaji\n          english\n          native\n        }\n        coverImage {\n          extraLarge\n          large\n          medium\n        }\n        format\n        countryOfOrigin\n      }\n    }\n  `;\n\n  try {\n    const response = await fetch(ANILIST_API, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json',\n      },\n      body: JSON.stringify({\n        query,\n        variables: { search: cleanTitle }\n      })\n    });\n\n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n\n    const data = await response.json();\n    \n    if (data.data?.Media?.coverImage) {\n      const cover = data.data.Media.coverImage.extraLarge || \n                    data.data.Media.coverImage.large || \n                    data.data.Media.coverImage.medium;\n      \n      if (cover) {\n        console.log(`âœ… [AniList] TrouvÃ© pour \"${cleanTitle}\":`, data.data.Media.title.romaji || data.data.Media.title.english);\n        return cover;\n      }\n    }\n  } catch (error) {\n    console.log(`âŒ [AniList] Erreur pour \"${cleanTitle}\":`, error.message);\n  }\n  return null;\n};\n\n// Recherche sur Google Books\nexport const searchGoogleBooksCover = async (title) => {\n  try {\n    const response = await fetch(\n      `https://www.googleapis.com/books/v1/volumes?q=${encodeURIComponent(title)}&maxResults=1`\n    );\n    \n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n    \n    const data = await response.json();\n    \n    if (data.items && data.items[0]?.volumeInfo?.imageLinks) {\n      const imageLinks = data.items[0].volumeInfo.imageLinks;\n      // Remplacer http par https pour Ã©viter les erreurs\n      const url = imageLinks.large || imageLinks.medium || imageLinks.thumbnail;\n      return url ? url.replace('http://', 'https://') : null;\n    }\n  } catch (error) {\n    console.log('Google Books: couverture non trouvÃ©e pour', title, error.message);\n  }\n  return null;\n};\n\n// GÃ©nÃ©ration de fallback avec style manga/anime\nconst getFallbackCover = (title) => {\n  // Utiliser des images d'anime/manga par dÃ©faut de Lorem Picsum avec IDs spÃ©cifiques\n  const animeImageIds = [\n    237, 1084, 1025, 823, 452, 883, 1069, \n    548, 659, 485, 593, 1074, 929, 447\n  ];\n  \n  const seed = title.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);\n  const imageId = animeImageIds[seed % animeImageIds.length];\n  \n  // Ajouter un filtre pour donner un aspect \"manga/anime\"\n  return `https://picsum.photos/id/${imageId}/400/600?grayscale&blur=1`;\n};\n\n// Fonction principale qui essaie toutes les sources\nexport const getCoverUrl = async (title) => {\n  console.log(`ðŸ” Recherche de couverture pour: \"${title}\"`);\n  \n  // Essayer d'abord Anilist (meilleur pour manhwas/webtoons/mangas)\n  let cover = await searchAnilistCover(title);\n  if (cover) {\n    console.log(`âœ… Couverture AniList trouvÃ©e pour: ${title}`);\n    return cover;\n  }\n\n  // Puis Google Books (pour les light novels)\n  cover = await searchGoogleBooksCover(title);\n  if (cover) {\n    console.log(`âœ… Couverture Google Books trouvÃ©e pour: ${title}`);\n    return cover;\n  }\n\n  // Fallback : image gÃ©nÃ©rÃ©e avec style manga\n  console.log(`âš ï¸ Aucune couverture trouvÃ©e, utilisation fallback pour: ${title}`);\n  return getFallbackCover(title);\n};\n\n// Version synchrone pour l'import rapide (utilise fallback immÃ©diatement)\nexport const getCoverUrlSync = (title) => {\n  return getFallbackCover(title);\n};\n\n// Fonction pour mettre Ã  jour une couverture aprÃ¨s coup\nexport const updateCoverAsync = async (title) => {\n  return await getCoverUrl(title);\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}