{"ast":null,"code":"const ANILIST_API = 'https://graphql.anilist.co';\n\n// Recherche sur Anilist (manhwas, mangas, webtoons) - VERSION AMÉLIORÉE\nexport const searchAnilistCover = async title => {\n  // Nettoyer le titre pour améliorer la recherche\n  let cleanTitle = title.replace(/\\s*ep\\s*\\d+.*$/i, '') // Supprimer \"ep XXX\"\n  .replace(/\\s*chapter\\s*\\d+.*$/i, '') // Supprimer \"chapter XXX\"\n  .replace(/\\s*end\\s*$/i, '') // Supprimer \"End\"\n  .trim();\n  const query = `\n    query ($search: String) {\n      Media(search: $search, type: MANGA, sort: SEARCH_MATCH) {\n        id\n        title {\n          romaji\n          english\n          native\n        }\n        coverImage {\n          extraLarge\n          large\n          medium\n        }\n        format\n        countryOfOrigin\n      }\n    }\n  `;\n  try {\n    var _data$data, _data$data$Media;\n    const response = await fetch(ANILIST_API, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json'\n      },\n      body: JSON.stringify({\n        query,\n        variables: {\n          search: cleanTitle\n        }\n      })\n    });\n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n    const data = await response.json();\n    if ((_data$data = data.data) !== null && _data$data !== void 0 && (_data$data$Media = _data$data.Media) !== null && _data$data$Media !== void 0 && _data$data$Media.coverImage) {\n      const cover = data.data.Media.coverImage.extraLarge || data.data.Media.coverImage.large || data.data.Media.coverImage.medium;\n      if (cover) {\n        console.log(`✅ [AniList] Trouvé pour \"${cleanTitle}\":`, data.data.Media.title.romaji || data.data.Media.title.english);\n        return cover;\n      }\n    }\n  } catch (error) {\n    console.log(`❌ [AniList] Erreur pour \"${cleanTitle}\":`, error.message);\n  }\n  return null;\n};","map":{"version":3,"names":["ANILIST_API","searchAnilistCover","title","cleanTitle","replace","trim","query","_data$data","_data$data$Media","response","fetch","method","headers","body","JSON","stringify","variables","search","ok","Error","status","data","json","Media","coverImage","cover","extraLarge","large","medium","console","log","romaji","english","error","message"],"sources":["/etudiants/siscol/f/ferna_ji/Bureau/BookTime/src/utils/imageGenerator.js"],"sourcesContent":["const ANILIST_API = 'https://graphql.anilist.co';\n\n// Recherche sur Anilist (manhwas, mangas, webtoons) - VERSION AMÉLIORÉE\nexport const searchAnilistCover = async (title) => {\n  // Nettoyer le titre pour améliorer la recherche\n  let cleanTitle = title\n    .replace(/\\s*ep\\s*\\d+.*$/i, '') // Supprimer \"ep XXX\"\n    .replace(/\\s*chapter\\s*\\d+.*$/i, '') // Supprimer \"chapter XXX\"\n    .replace(/\\s*end\\s*$/i, '') // Supprimer \"End\"\n    .trim();\n\n  const query = `\n    query ($search: String) {\n      Media(search: $search, type: MANGA, sort: SEARCH_MATCH) {\n        id\n        title {\n          romaji\n          english\n          native\n        }\n        coverImage {\n          extraLarge\n          large\n          medium\n        }\n        format\n        countryOfOrigin\n      }\n    }\n  `;\n\n  try {\n    const response = await fetch(ANILIST_API, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json',\n      },\n      body: JSON.stringify({\n        query,\n        variables: { search: cleanTitle }\n      })\n    });\n\n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n\n    const data = await response.json();\n    \n    if (data.data?.Media?.coverImage) {\n      const cover = data.data.Media.coverImage.extraLarge || \n                    data.data.Media.coverImage.large || \n                    data.data.Media.coverImage.medium;\n      \n      if (cover) {\n        console.log(`✅ [AniList] Trouvé pour \"${cleanTitle}\":`, data.data.Media.title.romaji || data.data.Media.title.english);\n        return cover;\n      }\n    }\n  } catch (error) {\n    console.log(`❌ [AniList] Erreur pour \"${cleanTitle}\":`, error.message);\n  }\n  return null;\n};"],"mappings":"AAAA,MAAMA,WAAW,GAAG,4BAA4B;;AAEhD;AACA,OAAO,MAAMC,kBAAkB,GAAG,MAAOC,KAAK,IAAK;EACjD;EACA,IAAIC,UAAU,GAAGD,KAAK,CACnBE,OAAO,CAAC,iBAAiB,EAAE,EAAE,CAAC,CAAC;EAAA,CAC/BA,OAAO,CAAC,sBAAsB,EAAE,EAAE,CAAC,CAAC;EAAA,CACpCA,OAAO,CAAC,aAAa,EAAE,EAAE,CAAC,CAAC;EAAA,CAC3BC,IAAI,CAAC,CAAC;EAET,MAAMC,KAAK,GAAG;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;EAED,IAAI;IAAA,IAAAC,UAAA,EAAAC,gBAAA;IACF,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAACV,WAAW,EAAE;MACxCW,MAAM,EAAE,MAAM;MACdC,OAAO,EAAE;QACP,cAAc,EAAE,kBAAkB;QAClC,QAAQ,EAAE;MACZ,CAAC;MACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;QACnBT,KAAK;QACLU,SAAS,EAAE;UAAEC,MAAM,EAAEd;QAAW;MAClC,CAAC;IACH,CAAC,CAAC;IAEF,IAAI,CAACM,QAAQ,CAACS,EAAE,EAAE;MAChB,MAAM,IAAIC,KAAK,CAAC,uBAAuBV,QAAQ,CAACW,MAAM,EAAE,CAAC;IAC3D;IAEA,MAAMC,IAAI,GAAG,MAAMZ,QAAQ,CAACa,IAAI,CAAC,CAAC;IAElC,KAAAf,UAAA,GAAIc,IAAI,CAACA,IAAI,cAAAd,UAAA,gBAAAC,gBAAA,GAATD,UAAA,CAAWgB,KAAK,cAAAf,gBAAA,eAAhBA,gBAAA,CAAkBgB,UAAU,EAAE;MAChC,MAAMC,KAAK,GAAGJ,IAAI,CAACA,IAAI,CAACE,KAAK,CAACC,UAAU,CAACE,UAAU,IACrCL,IAAI,CAACA,IAAI,CAACE,KAAK,CAACC,UAAU,CAACG,KAAK,IAChCN,IAAI,CAACA,IAAI,CAACE,KAAK,CAACC,UAAU,CAACI,MAAM;MAE/C,IAAIH,KAAK,EAAE;QACTI,OAAO,CAACC,GAAG,CAAC,4BAA4B3B,UAAU,IAAI,EAAEkB,IAAI,CAACA,IAAI,CAACE,KAAK,CAACrB,KAAK,CAAC6B,MAAM,IAAIV,IAAI,CAACA,IAAI,CAACE,KAAK,CAACrB,KAAK,CAAC8B,OAAO,CAAC;QACtH,OAAOP,KAAK;MACd;IACF;EACF,CAAC,CAAC,OAAOQ,KAAK,EAAE;IACdJ,OAAO,CAACC,GAAG,CAAC,4BAA4B3B,UAAU,IAAI,EAAE8B,KAAK,CAACC,OAAO,CAAC;EACxE;EACA,OAAO,IAAI;AACb,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}