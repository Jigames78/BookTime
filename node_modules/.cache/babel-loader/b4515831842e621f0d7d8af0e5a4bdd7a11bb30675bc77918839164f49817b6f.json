{"ast":null,"code":"const ANILIST_API = 'https://graphql.anilist.co';\n\n// Recherche sur Anilist (manhwas, mangas, webtoons)\nexport const searchAnilistCover = async title => {\n  const query = `\n    query ($search: String) {\n      Media(search: $search, type: MANGA, sort: SEARCH_MATCH) {\n        coverImage {\n          extraLarge\n          large\n        }\n      }\n    }\n  `;\n  try {\n    var _data$data, _data$data$Media;\n    const response = await fetch(ANILIST_API, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json'\n      },\n      body: JSON.stringify({\n        query,\n        variables: {\n          search: title\n        }\n      })\n    });\n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n    const data = await response.json();\n    if ((_data$data = data.data) !== null && _data$data !== void 0 && (_data$data$Media = _data$data.Media) !== null && _data$data$Media !== void 0 && _data$data$Media.coverImage) {\n      return data.data.Media.coverImage.extraLarge || data.data.Media.coverImage.large;\n    }\n  } catch (error) {\n    console.log('Anilist: couverture non trouvée pour', title, error.message);\n  }\n  return null;\n};\n\n// Recherche sur Google Books\nexport const searchGoogleBooksCover = async title => {\n  try {\n    var _data$items$, _data$items$$volumeIn;\n    const response = await fetch(`https://www.googleapis.com/books/v1/volumes?q=${encodeURIComponent(title)}&maxResults=1`);\n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n    const data = await response.json();\n    if (data.items && (_data$items$ = data.items[0]) !== null && _data$items$ !== void 0 && (_data$items$$volumeIn = _data$items$.volumeInfo) !== null && _data$items$$volumeIn !== void 0 && _data$items$$volumeIn.imageLinks) {\n      const imageLinks = data.items[0].volumeInfo.imageLinks;\n      // Remplacer http par https pour éviter les erreurs\n      const url = imageLinks.large || imageLinks.medium || imageLinks.thumbnail;\n      return url ? url.replace('http://', 'https://') : null;\n    }\n  } catch (error) {\n    console.log('Google Books: couverture non trouvée pour', title, error.message);\n  }\n  return null;\n};\n\n// Génération de fallback (image par défaut si rien trouvé)\nconst getFallbackCover = title => {\n  const seed = title.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);\n  return `https://picsum.photos/seed/${seed}/400/600`;\n};\n\n// Fonction principale qui essaie toutes les sources\nexport const getCoverUrl = async title => {\n  // Essayer d'abord Anilist (meilleur pour manhwas/webtoons)\n  let cover = await searchAnilistCover(title);\n  if (cover) {\n    console.log('✅ Couverture trouvée sur Anilist:', title);\n    return cover;\n  }\n\n  // Puis Google Books\n  cover = await searchGoogleBooksCover(title);\n  if (cover) {\n    console.log('✅ Couverture trouvée sur Google Books:', title);\n    return cover;\n  }\n\n  // Fallback : image générée\n  console.log('⚠️ Utilisation image par défaut pour:', title);\n  return getFallbackCover(title);\n};\n\n// Version synchrone pour l'import rapide (utilise fallback immédiatement)\nexport const getCoverUrlSync = title => {\n  return getFallbackCover(title);\n};\n\n// Fonction pour mettre à jour une couverture après coup\nexport const updateCoverAsync = async title => {\n  return await getCoverUrl(title);\n};","map":{"version":3,"names":["ANILIST_API","searchAnilistCover","title","query","_data$data","_data$data$Media","response","fetch","method","headers","body","JSON","stringify","variables","search","ok","Error","status","data","json","Media","coverImage","extraLarge","large","error","console","log","message","searchGoogleBooksCover","_data$items$","_data$items$$volumeIn","encodeURIComponent","items","volumeInfo","imageLinks","url","medium","thumbnail","replace","getFallbackCover","seed","split","reduce","acc","char","charCodeAt","getCoverUrl","cover","getCoverUrlSync","updateCoverAsync"],"sources":["/etudiants/siscol/f/ferna_ji/Bureau/BookTime/src/utils/imageGenerator.js"],"sourcesContent":["const ANILIST_API = 'https://graphql.anilist.co';\n\n// Recherche sur Anilist (manhwas, mangas, webtoons)\nexport const searchAnilistCover = async (title) => {\n  const query = `\n    query ($search: String) {\n      Media(search: $search, type: MANGA, sort: SEARCH_MATCH) {\n        coverImage {\n          extraLarge\n          large\n        }\n      }\n    }\n  `;\n\n  try {\n    const response = await fetch(ANILIST_API, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json',\n      },\n      body: JSON.stringify({\n        query,\n        variables: { search: title }\n      })\n    });\n\n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n\n    const data = await response.json();\n    \n    if (data.data?.Media?.coverImage) {\n      return data.data.Media.coverImage.extraLarge || data.data.Media.coverImage.large;\n    }\n  } catch (error) {\n    console.log('Anilist: couverture non trouvée pour', title, error.message);\n  }\n  return null;\n};\n\n// Recherche sur Google Books\nexport const searchGoogleBooksCover = async (title) => {\n  try {\n    const response = await fetch(\n      `https://www.googleapis.com/books/v1/volumes?q=${encodeURIComponent(title)}&maxResults=1`\n    );\n    \n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n    \n    const data = await response.json();\n    \n    if (data.items && data.items[0]?.volumeInfo?.imageLinks) {\n      const imageLinks = data.items[0].volumeInfo.imageLinks;\n      // Remplacer http par https pour éviter les erreurs\n      const url = imageLinks.large || imageLinks.medium || imageLinks.thumbnail;\n      return url ? url.replace('http://', 'https://') : null;\n    }\n  } catch (error) {\n    console.log('Google Books: couverture non trouvée pour', title, error.message);\n  }\n  return null;\n};\n\n// Génération de fallback (image par défaut si rien trouvé)\nconst getFallbackCover = (title) => {\n  const seed = title.split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);\n  return `https://picsum.photos/seed/${seed}/400/600`;\n};\n\n// Fonction principale qui essaie toutes les sources\nexport const getCoverUrl = async (title) => {\n  // Essayer d'abord Anilist (meilleur pour manhwas/webtoons)\n  let cover = await searchAnilistCover(title);\n  if (cover) {\n    console.log('✅ Couverture trouvée sur Anilist:', title);\n    return cover;\n  }\n\n  // Puis Google Books\n  cover = await searchGoogleBooksCover(title);\n  if (cover) {\n    console.log('✅ Couverture trouvée sur Google Books:', title);\n    return cover;\n  }\n\n  // Fallback : image générée\n  console.log('⚠️ Utilisation image par défaut pour:', title);\n  return getFallbackCover(title);\n};\n\n// Version synchrone pour l'import rapide (utilise fallback immédiatement)\nexport const getCoverUrlSync = (title) => {\n  return getFallbackCover(title);\n};\n\n// Fonction pour mettre à jour une couverture après coup\nexport const updateCoverAsync = async (title) => {\n  return await getCoverUrl(title);\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}