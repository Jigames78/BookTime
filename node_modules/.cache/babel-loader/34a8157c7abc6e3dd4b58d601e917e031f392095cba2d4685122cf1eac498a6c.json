{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { DEFAULT_HEADERS } from './constants';\nimport { isStorageVectorsError } from './errors';\nimport { post } from './fetch';\nimport { resolveFetch } from './helpers';\n/**\r\n * API class for managing Vector Indexes within Vector Buckets\r\n * Provides methods for creating, reading, listing, and deleting vector indexes\r\n */\nexport default class VectorIndexApi {\n  constructor(url) {\n    let headers = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    let fetch = arguments.length > 2 ? arguments[2] : undefined;\n    this.shouldThrowOnError = false;\n    this.url = url.replace(/\\/$/, '');\n    this.headers = Object.assign(Object.assign({}, DEFAULT_HEADERS), headers);\n    this.fetch = resolveFetch(fetch);\n  }\n  /**\r\n   * Enable throwing errors instead of returning them in the response\r\n   * When enabled, failed operations will throw instead of returning { data: null, error }\r\n   *\r\n   * @returns This instance for method chaining\r\n   * @example\r\n   * ```typescript\r\n   * const client = new VectorIndexApi(url, headers)\r\n   * client.throwOnError()\r\n   * const { data } = await client.createIndex(options) // throws on error\r\n   * ```\r\n   */\n  throwOnError() {\n    this.shouldThrowOnError = true;\n    return this;\n  }\n  /**\r\n   * Creates a new vector index within a bucket\r\n   * Defines the schema for vectors including dimensionality, distance metric, and metadata config\r\n   *\r\n   * @param options - Index configuration\r\n   * @param options.vectorBucketName - Name of the parent vector bucket\r\n   * @param options.indexName - Unique name for the index within the bucket\r\n   * @param options.dataType - Data type for vector components (currently only 'float32')\r\n   * @param options.dimension - Dimensionality of vectors (e.g., 384, 768, 1536)\r\n   * @param options.distanceMetric - Similarity metric ('cosine', 'euclidean', 'dotproduct')\r\n   * @param options.metadataConfiguration - Optional config for non-filterable metadata keys\r\n   * @returns Promise with empty response on success or error\r\n   *\r\n   * @throws {StorageVectorsApiError} With code:\r\n   * - `S3VectorConflictException` if index already exists (HTTP 409)\r\n   * - `S3VectorMaxIndexesExceeded` if quota exceeded (HTTP 400)\r\n   * - `S3VectorNotFoundException` if bucket doesn't exist (HTTP 404)\r\n   * - `InternalError` for server errors (HTTP 500)\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const { data, error } = await client.createIndex({\r\n   *   vectorBucketName: 'embeddings-prod',\r\n   *   indexName: 'documents-openai-small',\r\n   *   dataType: 'float32',\r\n   *   dimension: 1536,\r\n   *   distanceMetric: 'cosine',\r\n   *   metadataConfiguration: {\r\n   *     nonFilterableMetadataKeys: ['raw_text', 'internal_id']\r\n   *   }\r\n   * })\r\n   * ```\r\n   */\n  createIndex(options) {\n    return __awaiter(this, void 0, void 0, function* () {\n      try {\n        const data = yield post(this.fetch, \"\".concat(this.url, \"/CreateIndex\"), options, {\n          headers: this.headers\n        });\n        return {\n          data: data || {},\n          error: null\n        };\n      } catch (error) {\n        if (this.shouldThrowOnError) {\n          throw error;\n        }\n        if (isStorageVectorsError(error)) {\n          return {\n            data: null,\n            error\n          };\n        }\n        throw error;\n      }\n    });\n  }\n  /**\r\n   * Retrieves metadata for a specific vector index\r\n   * Returns index configuration including dimension, distance metric, and metadata settings\r\n   *\r\n   * @param vectorBucketName - Name of the parent vector bucket\r\n   * @param indexName - Name of the index to retrieve\r\n   * @returns Promise with index metadata or error\r\n   *\r\n   * @throws {StorageVectorsApiError} With code:\r\n   * - `S3VectorNotFoundException` if index or bucket doesn't exist (HTTP 404)\r\n   * - `InternalError` for server errors (HTTP 500)\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * const { data, error } = await client.getIndex('embeddings-prod', 'documents-openai-small')\r\n   * if (data) {\r\n   *   console.log('Index dimension:', data.index.dimension)\r\n   *   console.log('Distance metric:', data.index.distanceMetric)\r\n   * }\r\n   * ```\r\n   */\n  getIndex(vectorBucketName, indexName) {\n    return __awaiter(this, void 0, void 0, function* () {\n      try {\n        const data = yield post(this.fetch, \"\".concat(this.url, \"/GetIndex\"), {\n          vectorBucketName,\n          indexName\n        }, {\n          headers: this.headers\n        });\n        return {\n          data,\n          error: null\n        };\n      } catch (error) {\n        if (this.shouldThrowOnError) {\n          throw error;\n        }\n        if (isStorageVectorsError(error)) {\n          return {\n            data: null,\n            error\n          };\n        }\n        throw error;\n      }\n    });\n  }\n  /**\r\n   * Lists vector indexes within a bucket with optional filtering and pagination\r\n   * Supports prefix-based filtering and paginated results\r\n   *\r\n   * @param options - Listing options\r\n   * @param options.vectorBucketName - Name of the parent vector bucket\r\n   * @param options.prefix - Filter indexes by name prefix\r\n   * @param options.maxResults - Maximum results per page (default: 100)\r\n   * @param options.nextToken - Pagination token from previous response\r\n   * @returns Promise with list of indexes and pagination token\r\n   *\r\n   * @throws {StorageVectorsApiError} With code:\r\n   * - `S3VectorNotFoundException` if bucket doesn't exist (HTTP 404)\r\n   * - `InternalError` for server errors (HTTP 500)\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // List all indexes in a bucket\r\n   * const { data, error } = await client.listIndexes({\r\n   *   vectorBucketName: 'embeddings-prod',\r\n   *   prefix: 'documents-'\r\n   * })\r\n   * if (data) {\r\n   *   console.log('Found indexes:', data.indexes.map(i => i.indexName))\r\n   *   // Fetch next page if available\r\n   *   if (data.nextToken) {\r\n   *     const next = await client.listIndexes({\r\n   *       vectorBucketName: 'embeddings-prod',\r\n   *       nextToken: data.nextToken\r\n   *     })\r\n   *   }\r\n   * }\r\n   * ```\r\n   */\n  listIndexes(options) {\n    return __awaiter(this, void 0, void 0, function* () {\n      try {\n        const data = yield post(this.fetch, \"\".concat(this.url, \"/ListIndexes\"), options, {\n          headers: this.headers\n        });\n        return {\n          data,\n          error: null\n        };\n      } catch (error) {\n        if (this.shouldThrowOnError) {\n          throw error;\n        }\n        if (isStorageVectorsError(error)) {\n          return {\n            data: null,\n            error\n          };\n        }\n        throw error;\n      }\n    });\n  }\n  /**\r\n   * Deletes a vector index and all its data\r\n   * This operation removes the index schema and all vectors stored in the index\r\n   *\r\n   * @param vectorBucketName - Name of the parent vector bucket\r\n   * @param indexName - Name of the index to delete\r\n   * @returns Promise with empty response on success or error\r\n   *\r\n   * @throws {StorageVectorsApiError} With code:\r\n   * - `S3VectorNotFoundException` if index or bucket doesn't exist (HTTP 404)\r\n   * - `InternalError` for server errors (HTTP 500)\r\n   *\r\n   * @example\r\n   * ```typescript\r\n   * // Delete an index and all its vectors\r\n   * const { error } = await client.deleteIndex('embeddings-prod', 'old-index')\r\n   * if (!error) {\r\n   *   console.log('Index deleted successfully')\r\n   * }\r\n   * ```\r\n   */\n  deleteIndex(vectorBucketName, indexName) {\n    return __awaiter(this, void 0, void 0, function* () {\n      try {\n        const data = yield post(this.fetch, \"\".concat(this.url, \"/DeleteIndex\"), {\n          vectorBucketName,\n          indexName\n        }, {\n          headers: this.headers\n        });\n        return {\n          data: data || {},\n          error: null\n        };\n      } catch (error) {\n        if (this.shouldThrowOnError) {\n          throw error;\n        }\n        if (isStorageVectorsError(error)) {\n          return {\n            data: null,\n            error\n          };\n        }\n        throw error;\n      }\n    });\n  }\n}\n//# sourceMappingURL=VectorIndexApi.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}